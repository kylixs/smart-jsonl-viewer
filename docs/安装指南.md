# JSONL Viewer 安装指南

## 前置要求

- Node.js 16+
- npm 或 yarn
- Chrome 浏览器 88+ 或其他 Chromium 内核浏览器

---

## 安装步骤

### 步骤 1：获取源代码

```bash
# 克隆仓库（如果你有 git 仓库地址）
git clone <repository-url>
cd jsonline-viewer

# 或者直接解压项目文件夹
cd jsonline-viewer
```

### 步骤 2：安装依赖

```bash
npm install
```

这将安装以下依赖：
- Vue 3
- Pinia
- Vite
- TypeScript
- 以及其他开发工具

### 步骤 3：构建扩展

```bash
npm run build
```

构建过程包括：
1. TypeScript 类型检查
2. Vite 打包优化
3. 自动复制 manifest.json 到 dist 目录
4. 准备图标资源

构建成功后，会在项目根目录生成 `dist/` 文件夹。

### 步骤 4：准备图标（可选）

为了更好的视觉效果，建议添加自定义图标：

1. 准备以下尺寸的图标文件：
   - 16x16 像素：`icon-16.png`
   - 48x48 像素：`icon-48.png`
   - 128x128 像素：`icon-128.png`

2. 将图标文件放到 `public/icons/` 目录

3. 重新运行构建：
   ```bash
   npm run build
   ```

**注意**：如果跳过此步骤，扩展依然可以正常使用，只是会显示默认图标。

### 步骤 5：在 Chrome 中加载扩展

1. **打开扩展管理页面**
   - 在 Chrome 地址栏输入：`chrome://extensions/`
   - 或通过菜单：更多工具 → 扩展程序

2. **启用开发者模式**
   - 找到页面右上角的"开发者模式"开关
   - 将其切换到"开启"状态

3. **加载扩展**
   - 点击左上角的"加载已解压的扩展程序"按钮
   - 在文件选择器中，导航到项目目录
   - 选择 `dist` 文件夹
   - 点击"选择文件夹"

4. **确认安装成功**
   - 扩展列表中会出现"JSONL Viewer"
   - 浏览器工具栏会显示扩展图标
   - 状态显示为"已启用"

---

## 开发模式（可选）

如果你想在开发过程中实时预览更改：

```bash
npm run dev
```

这会启动 Vite 开发服务器，通常在 `http://localhost:5173` 访问。

**注意**：开发模式下只能测试查看器界面，无法测试 Chrome 扩展功能（如网页拦截）。要测试完整功能，必须构建并加载到 Chrome。

---

## 验证安装

### 测试本地文件查看

1. 点击扩展图标打开查看器
2. 准备一个测试文件 `test.jsonl`：
   ```json
   {"name": "Alice", "age": 30, "message": "Hello\\nWorld"}
   {"name": "Bob", "age": 25, "data": "{\"nested\": true}"}
   ```
3. 拖拽文件到查看器
4. 验证功能：
   - ✅ 文件成功加载
   - ✅ 可以展开/折叠行
   - ✅ 字符串解码按钮可用
   - ✅ 搜索功能正常

### 测试网页拦截

1. 创建一个测试 HTML 文件 `test.html`：
   ```html
   <!DOCTYPE html>
   <html>
   <head>
       <meta charset="utf-8">
       <title>Test JSONL</title>
   </head>
   <body>
   {"line": 1, "data": "test"}
   {"line": 2, "data": "hello"}
   </body>
   </html>
   ```

2. 在 Chrome 中打开此文件
3. 验证扩展自动美化显示

---

## 故障排除

### 问题 1：构建失败

**症状**：`npm run build` 报错

**解决方法**：
```bash
# 清理缓存
rm -rf node_modules package-lock.json
npm cache clean --force

# 重新安装
npm install
npm run build
```

### 问题 2：扩展加载失败

**症状**：Chrome 提示"无法加载扩展"

**可能原因**：
- manifest.json 格式错误
- dist 目录不存在或为空

**解决方法**：
```bash
# 确保构建成功
npm run build

# 检查 dist 目录
ls -la dist/
# 应该包含：manifest.json, index.html, background.js, content.js 等
```

### 问题 3：扩展图标不显示

**原因**：图标文件缺失

**解决方法**：
- 暂时忽略（不影响功能）
- 或按照步骤 4 添加图标文件

### 问题 4：TypeScript 类型错误

**症状**：构建时出现 TS 错误

**解决方法**：
```bash
# 检查 TypeScript 版本
npx tsc --version

# 如果需要，更新依赖
npm update
```

---

## 更新扩展

当你修改代码后：

1. 重新构建：
   ```bash
   npm run build
   ```

2. 在 Chrome 扩展页面点击刷新图标：
   - 找到 JSONL Viewer 扩展
   - 点击卡片上的刷新按钮 🔄

3. 刷新正在使用扩展的页面

---

## 卸载

1. 在 `chrome://extensions/` 找到 JSONL Viewer
2. 点击"移除"按钮
3. 确认删除

---

## 下一步

✅ 安装完成后，查看以下文档：

- [使用指南](./使用指南.md) - 详细功能说明
- [技术方案](./技术方案.md) - 架构和实现细节
- [README](../README.md) - 项目概览

---

## 获取帮助

遇到问题？

- 查看 [常见问题](./使用指南.md#常见问题)
- 提交 [GitHub Issue](https://github.com/your-repo/issues)
- 查看项目文档
